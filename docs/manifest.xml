<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
           xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.1"
           xsi:type="MailApp">

  <!-- MUST be a real GUID -->
  <Id>9fde97fa-c70a-4a01-805e-3064237c2fb2</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>Matcha Demo</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>

  <DisplayName DefaultValue="Matcha Email Helper"/>
  <Description DefaultValue="Rewrite drafts using Matcha AI."/>

  <!-- Use PNGs (SVG will fail validation) -->
  <IconUrl DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/assets/MatchaAILogo_80.png"/>
  <HighResolutionIconUrl DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/assets/MatchaAILogo_80.png"/>

  <!-- Must be reachable (200 OK). taskpane.html is known-good. -->
  <SupportUrl DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/taskpane.html"/>

  <AppDomains>
    <AppDomain>https://asmacc.github.io</AppDomain>
    <AppDomain>https://matchaflow.harriscomputer.com</AppDomain>
  </AppDomains>

  <Hosts>
    <Host Name="Mailbox"/>
  </Hosts>

  <Requirements>
    <Sets>
      <Set Name="Mailbox" MinVersion="1.8"/>
    </Sets>
  </Requirements>

  <FormSettings>
    <Form xsi:type="ItemEdit">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/taskpane.html"/>
      </DesktopSettings>
    </Form>
  </FormSettings>

  <Permissions>ReadWriteItem</Permissions>

  <Rule xsi:type="RuleCollection" Mode="Or">
    <Rule xsi:type="ItemIs" ItemType="Message" FormType="Edit"/>
  </Rule>

  <!-- IMPORTANT: Use the mailappor prefix so schema validation passes -->
  <mailappor:VersionOverrides xsi:type="mailappor:VersionOverridesV1_1">
    <mailappor:Hosts>
      <mailappor:Host xsi:type="mailappor:MailHost">
        <mailappor:DesktopFormFactor>
          <mailappor:ExtensionPoint xsi:type="mailappor:MessageComposeCommandSurface">
            <mailappor:OfficeTab id="TabDefault">
              <mailappor:Group id="grpMatcha">
                <mailappor:Label resid="resGroupLabel"/>
                <mailappor:Control xsi:type="mailappor:Button" id="btnMatchaTaskpane">
                  <mailappor:Label resid="resButtonLabel"/>
                  <mailappor:Supertip>
                    <mailappor:Title resid="resButtonLabel"/>
                    <mailappor:Description resid="resButtonDesc"/>
                  </mailappor:Supertip>
                  <mailappor:Icon>
                    <bt:Image size="16" resid="icon16"/>
                    <bt:Image size="32" resid="icon32"/>
                    <bt:Image size="80" resid="icon80"/>
                  </mailappor:Icon>
                  <mailappor:Action xsi:type="mailappor:ShowTaskpane">
                    <mailappor:SourceLocation resid="resTaskpaneUrl"/>
                  </mailappor:Action>
                </mailappor:Control>
              </mailappor:Group>
            </mailappor:OfficeTab>
          </mailappor:ExtensionPoint>
        </mailappor:DesktopFormFactor>
      </mailappor:Host>
    </mailappor:Hosts>

    <mailappor:Resources>
      <bt:Images>
        <bt:Image id="icon16" DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/assets/MatchaAILogo_16.png"/>
        <bt:Image id="icon32" DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/assets/MatchaAILogo_32.png"/>
        <bt:Image id="icon80" DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/assets/MatchaAILogo_80.png"/>
      </bt:Images>
      <bt:Urls>
        <bt:Url id="resTaskpaneUrl" DefaultValue="https://asmacc.github.io/MatchaOutlookWriter/taskpane.html"/>
      </bt:Urls>
      <bt:ShortStrings>
        <bt:String id="resGroupLabel" DefaultValue="Matcha"/>
        <bt:String id="resButtonLabel" DefaultValue="Rewrite with Matcha"/>
      </bt:ShortStrings>
      <bt:LongStrings>
        <bt:String id="resButtonDesc" DefaultValue="Opens a task pane to rewrite the current draft using Matcha AI."/>
      </bt:LongStrings>
    </mailappor:Resources>
  </mailappor:VersionOverrides>

</OfficeApp>
